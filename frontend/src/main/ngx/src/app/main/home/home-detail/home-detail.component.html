<o-form #oForm service="partes" entity="parte" keys="IDPARTE" header-actions="R;U;D" show-header-navigation="no">
  <o-text-input attr="IDPARTE" sql-type="INTEGER" enabled="no" fxFlex></o-text-input>
  <div *ngIf="oForm.getDataValue('ENDDATE').value; else elseBlock">
    <o-row>
      <o-column title-label="PARTE INFORMATION" fxFlex>
        <o-row>
          <o-text-input class="input-padding" attr="DESCRIPTION" fxFlex="50" enabled="no" required="yes">
          </o-text-input>
        </o-row>
        <o-row layout-gap="14px" layout-padding-vertical>
          <o-date-input attr="STARTDATE" required="yes" fxFlex="25" enabled="no"></o-date-input>
          <o-date-input attr="ENDDATE" enabled="no" fxFlex="25"></o-date-input>
        </o-row>
        <o-row>
          <o-combo attr="STATUS" service="partes" entity="status" columns="ID;DESCRIPTION" value-column="ID" keys="ID"
            visible-columns="DESCRIPTION" enabled="no" fxFlex="50">
          </o-combo>
        </o-row>
        <o-row>
          <o-textarea-input attr="COMMENTS" enabled="no" fxFlex="50"></o-textarea-input>
        </o-row>
        <mat-tab-group>
          <mat-tab [label]="'SPENDINGS' | oTranslate">
            <o-list #list attr="spendinglist" service="gastos" entity="vGasto" keys="ID"
              columns="ID;CONCEPT;STARTDATE;CATEGORY;PRICE" selectable="true" insert-button="false"
              insert-button-position="top" insert-button-floatable="false" delete-button="no" quick-filter="false">
              <mat-card *ngFor="let rowData of list.dataArray" [o-list-item]="rowData">
                <mat-card-header>
                  <mat-card-title><strong>
                      <font size=3>{{ rowData.CONCEPT }}</font>
                    </strong></mat-card-title>
                  <mat-card-subtitle>ID:{{rowData.ID}}</mat-card-subtitle>
                </mat-card-header>
                <mat-card-content>
                  <o-column>
                    {{'STARTDATE' | oTranslate }}: {{ rowData.STARTDATE | date  }}
                    <p>{{'CATEGORY' | oTranslate}}: {{ rowData.CATEGORY }}</p>
                  </o-column>
                </mat-card-content>
              </mat-card>
            </o-list>
          </mat-tab>
        </mat-tab-group>
      </o-column>
    </o-row>
  </div>
  <ng-template #elseBlock>
    <o-row>
      <o-column title-label="PARTE INFORMATION" fxFlex>
        <o-row>
          <o-text-input class="input-padding" attr="DESCRIPTION" fxFlex="50" required="yes">
          </o-text-input>
        </o-row>
        <o-row layout-gap="14px" layout-padding-vertical>
          <o-date-input attr="STARTDATE" required="yes" fxFlex="25"></o-date-input>
          <o-date-input #ENDDATE attr="ENDDATE" enabled="no" fxFlex="25"></o-date-input>
        </o-row>
        <o-row layout-gap="14px" layout-padding-vertical>
          <o-combo #STATUS (onChange)="valueChange($event)" attr="STATUS" service="partes" entity="status"
            columns="ID;DESCRIPTION" value-column="ID" keys="ID" visible-columns="DESCRIPTION" fxFlex="50">
          </o-combo>
        </o-row>
        <o-row>
          <o-textarea-input attr="COMMENTS" fxFlex="40"></o-textarea-input>
        </o-row>
        <mat-tab-group>
          <mat-tab [label]="'SPENDINGS' | oTranslate">
            <o-list #list attr="spendinglist" service="gastos" entity="parteg" keys="ID" parent-keys="IDPARTE"
              columns="ID;CONCEPT;STARTDATE;CATEGORY;PRICE" visible-columns="CONCEPT;STARTDATE;CATEGORY;PRICE" refresh-button="true" insert-button="true"
              quick-filter="false"  insert-button-position="bottom" insert-button-floatable="false" delete-button="true"
              selectable="true" dense="false" detail-button-in-row="true" detail-button-in-row-icon="chevron_right">
              <o-list-item *ngFor="let row of list.dataArray">
                <o-list-item-text #item title="{{ row.CONCEPT }}" primary-text="{{ row.STARTDATE | date}}">
                </o-list-item-text>
              </o-list-item>
            </o-list>
          </mat-tab>
        </mat-tab-group>
      </o-column>
    </o-row>
  </ng-template>
</o-form>