{"version":3,"file":"o-form-can-deactivate.guard.js","sourceRoot":"","sources":["../../../../../tmp/ontimize/components/form/guards/o-form-can-deactivate.guard.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,UAAU,EAAE,QAAQ,EAAE,MAAM,eAAe,CAAC;AAGrD,OAAO,EAAE,KAAK,EAAE,MAAM,gBAAgB,CAAC;AAEvC,OAAO,EAAE,YAAY,EAAE,MAAM,iCAAiC,CAAC;AAM/D;IAME,gCAAsB,QAAkB;QAAlB,aAAQ,GAAR,QAAQ,CAAU;QACtC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;IACtD,CAAC;IAGD,8CAAa,GAAb,UAAc,SAAiC,EAAE,IAA4B,EAAE,KAA0B,EAAE,MAA2B;QACpI,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE,EAAE;YACnC,OAAO,IAAI,CAAC;SACb;QACD,IAAM,iBAAiB,GAAG,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC;QAClD,IAAI,iBAAiB,CAAC,cAAc,CAAC,KAAK,CAAC,qBAAqB,CAAC,EAAE;YACjE,OAAO,IAAI,CAAC;SACb;QACD,IAAI,IAAI,CAAC,KAAK,EAAE;YACd,OAAO,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE,CAAC;SACnC;QACD,OAAO,IAAI,CAAC;IACd,CAAC;IAED,wCAAO,GAAP,UAAQ,IAAoB;QAC1B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;IACpB,CAAC;IAxBa,gCAAS,GAAG,wBAAwB,CAAC;;gBAHpD,UAAU;;;gBAXU,QAAQ;;IAuC7B,6BAAC;CAAA,AA5BD,IA4BC;SA3BY,sBAAsB","sourcesContent":["import { Injectable, Injector } from '@angular/core';\nimport { CanDeactivate, ActivatedRouteSnapshot, RouterStateSnapshot } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { Codes } from '../../../utils';\nimport { OFormComponent } from '../o-form.component';\nimport { LoginService } from '../../../services/login.service';\n\nexport interface CanComponentDeactivate {\n  canDeactivate: () => Observable<boolean> | Promise<boolean> | boolean;\n}\n\n@Injectable()\nexport class CanDeactivateFormGuard implements CanDeactivate<CanComponentDeactivate> {\n  oForm: OFormComponent;\n  public static CLASSNAME = 'CanDeactivateFormGuard';\n  private loginService: LoginService;\n\n  constructor(protected injector: Injector) {\n    this.loginService = this.injector.get(LoginService);\n  }\n\n\n  canDeactivate(component: CanComponentDeactivate, curr: ActivatedRouteSnapshot, state: RouterStateSnapshot, future: RouterStateSnapshot) {\n    if (!this.loginService.isLoggedIn()) {\n      return true;\n    }\n    const futureQueryParams = future.root.queryParams;\n    if (futureQueryParams.hasOwnProperty(Codes.IGNORE_CAN_DEACTIVATE)) {\n      return true;\n    }\n    if (this.oForm) {\n      return this.oForm.canDeactivate();\n    }\n    return true;\n  }\n\n  setForm(form: OFormComponent) {\n    this.oForm = form;\n  }\n}\n\n"]}